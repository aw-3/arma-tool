<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>BlackBone: C:/Users/Ton/Documents/Visual Studio 2013/Projects/BlackBone/src/BlackBoneDrv/Remap.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BlackBone
   </div>
   <div id="projectbrief">Windows memory hacking library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_remap_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Remap.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_private_8h_source.html">Private.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_vad_routines_8h_source.html">VadRoutines.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_black_bone_def_8h_source.html">BlackBoneDef.h</a>&quot;</code><br />
</div>
<p><a href="_remap_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___p_r_o_c_e_s_s___c_o_n_t_e_x_t.html">_PROCESS_CONTEXT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process-specific data  <a href="struct___p_r_o_c_e_s_s___c_o_n_t_e_x_t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___p_r_o_c_e_s_s___m_a_p___e_n_t_r_y.html">_PROCESS_MAP_ENTRY</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Target - host correspondence  <a href="struct___p_r_o_c_e_s_s___m_a_p___e_n_t_r_y.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___m_a_p___e_n_t_r_y.html">_MAP_ENTRY</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mapped memory region info  <a href="struct___m_a_p___e_n_t_r_y.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a008bfa69a48a0b43e64ce2cc0bd34805"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="_remap_8h.html#a71278ae06f76b08db92a13518998119c">_ATTACHED_CONTEXT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a008bfa69a48a0b43e64ce2cc0bd34805">ATTACHED_CONTEXT</a></td></tr>
<tr class="separator:a008bfa69a48a0b43e64ce2cc0bd34805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3041852b4d86bb70dd71221268549e6d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___p_r_o_c_e_s_s___c_o_n_t_e_x_t.html">_PROCESS_CONTEXT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a3041852b4d86bb70dd71221268549e6d">PROCESS_CONTEXT</a></td></tr>
<tr class="memdesc:a3041852b4d86bb70dd71221268549e6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process-specific data  <a href="#a3041852b4d86bb70dd71221268549e6d">More...</a><br /></td></tr>
<tr class="separator:a3041852b4d86bb70dd71221268549e6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52dc27c5e4029e2e7e3457763f7635c7"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___p_r_o_c_e_s_s___c_o_n_t_e_x_t.html">_PROCESS_CONTEXT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a52dc27c5e4029e2e7e3457763f7635c7">PPROCESS_CONTEXT</a></td></tr>
<tr class="separator:a52dc27c5e4029e2e7e3457763f7635c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68f800b382424732b9836bc34e166eab"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___p_r_o_c_e_s_s___m_a_p___e_n_t_r_y.html">_PROCESS_MAP_ENTRY</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a68f800b382424732b9836bc34e166eab">PROCESS_MAP_ENTRY</a></td></tr>
<tr class="memdesc:a68f800b382424732b9836bc34e166eab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Target - host correspondence  <a href="#a68f800b382424732b9836bc34e166eab">More...</a><br /></td></tr>
<tr class="separator:a68f800b382424732b9836bc34e166eab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeeaf100ad47c01b3a067e5c9cb218d2"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___p_r_o_c_e_s_s___m_a_p___e_n_t_r_y.html">_PROCESS_MAP_ENTRY</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a></td></tr>
<tr class="separator:afeeaf100ad47c01b3a067e5c9cb218d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cfddf725f2c1ecc87e0833f7e24539f"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___m_a_p___e_n_t_r_y.html">_MAP_ENTRY</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a9cfddf725f2c1ecc87e0833f7e24539f">MAP_ENTRY</a></td></tr>
<tr class="memdesc:a9cfddf725f2c1ecc87e0833f7e24539f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mapped memory region info  <a href="#a9cfddf725f2c1ecc87e0833f7e24539f">More...</a><br /></td></tr>
<tr class="separator:a9cfddf725f2c1ecc87e0833f7e24539f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa273bd9c4061c76fe1e2b5d0c59f85dc"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___m_a_p___e_n_t_r_y.html">_MAP_ENTRY</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a></td></tr>
<tr class="separator:aa273bd9c4061c76fe1e2b5d0c59f85dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a71278ae06f76b08db92a13518998119c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a71278ae06f76b08db92a13518998119c">_ATTACHED_CONTEXT</a> { <a class="el" href="_remap_8h.html#a71278ae06f76b08db92a13518998119cab4687aff0f798615d03fd2fe53adf574">ContextNone</a>, 
<a class="el" href="_remap_8h.html#a71278ae06f76b08db92a13518998119ca59d259a461cb99f6b07d0a6448fb0b48">ContextHost</a>, 
<a class="el" href="_remap_8h.html#a71278ae06f76b08db92a13518998119cad47a6469246e4c609c4ffc501d973cda">ContextTarget</a>
 }</td></tr>
<tr class="separator:a71278ae06f76b08db92a13518998119c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a477ab35d84eaab6198cd8c2b36966df5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a477ab35d84eaab6198cd8c2b36966df5">BBMapMemory</a> (IN <a class="el" href="_black_bone_def_8h.html#a756d94b3d8b59bf911ebef69c31224e3">PMAP_MEMORY</a> pRemap, OUT <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a> *ppEntry)</td></tr>
<tr class="memdesc:a477ab35d84eaab6198cd8c2b36966df5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map entire address space of target process into current  <a href="#a477ab35d84eaab6198cd8c2b36966df5">More...</a><br /></td></tr>
<tr class="separator:a477ab35d84eaab6198cd8c2b36966df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add6826b20572e5728507d4c040351cfd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#add6826b20572e5728507d4c040351cfd">BBMapMemoryRegion</a> (IN <a class="el" href="_black_bone_def_8h.html#a1973bf123a2adca43b1411769fb6153f">PMAP_MEMORY_REGION</a> pRegion, OUT <a class="el" href="_black_bone_def_8h.html#a7d8cb706531527e27eccba284162b7f4">PMAP_MEMORY_REGION_RESULT</a> pResult)</td></tr>
<tr class="memdesc:add6826b20572e5728507d4c040351cfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map specific memory region  <a href="#add6826b20572e5728507d4c040351cfd">More...</a><br /></td></tr>
<tr class="separator:add6826b20572e5728507d4c040351cfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cb21cac2fa196ad5abff8a9e90baee7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a1cb21cac2fa196ad5abff8a9e90baee7">BBUnmapMemory</a> (IN <a class="el" href="_black_bone_def_8h.html#aee5703b358f0279a38c1469f5126af8d">PUNMAP_MEMORY</a> pUnmap)</td></tr>
<tr class="memdesc:a1cb21cac2fa196ad5abff8a9e90baee7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmap any mapped memory from host and target processes  <a href="#a1cb21cac2fa196ad5abff8a9e90baee7">More...</a><br /></td></tr>
<tr class="separator:a1cb21cac2fa196ad5abff8a9e90baee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ed588f0df58d216e8593eb5e4a686f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a10ed588f0df58d216e8593eb5e4a686f">BBUnmapMemoryRegion</a> (IN <a class="el" href="_black_bone_def_8h.html#abe98aab52e6513851c7238d73233ba5e">PUNMAP_MEMORY_REGION</a> pRegion)</td></tr>
<tr class="memdesc:a10ed588f0df58d216e8593eb5e4a686f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmap specific memory region  <a href="#a10ed588f0df58d216e8593eb5e4a686f">More...</a><br /></td></tr>
<tr class="separator:a10ed588f0df58d216e8593eb5e4a686f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e26085ed53a0a82250d5f519fa91e57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a3e26085ed53a0a82250d5f519fa91e57">BBGetRequiredRemapOutputSize</a> (IN PLIST_ENTRY pList, OUT PULONG_PTR pSize)</td></tr>
<tr class="memdesc:a3e26085ed53a0a82250d5f519fa91e57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate size required to store mapping info  <a href="#a3e26085ed53a0a82250d5f519fa91e57">More...</a><br /></td></tr>
<tr class="separator:a3e26085ed53a0a82250d5f519fa91e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9160b10f2c993aa5b93d95b83004a46"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#ab9160b10f2c993aa5b93d95b83004a46">BBLookupProcessEntry</a> (IN HANDLE pid, IN BOOLEAN asHost)</td></tr>
<tr class="memdesc:ab9160b10f2c993aa5b93d95b83004a46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search process entry in list by PID  <a href="#ab9160b10f2c993aa5b93d95b83004a46">More...</a><br /></td></tr>
<tr class="separator:ab9160b10f2c993aa5b93d95b83004a46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7c25319f3aeb357cc37a64f3cb13b53"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#ac7c25319f3aeb357cc37a64f3cb13b53">BBCleanupProcessEntry</a> (IN <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a> pProcessEntry)</td></tr>
<tr class="memdesc:ac7c25319f3aeb357cc37a64f3cb13b53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmap all regions, delete MDLs, close handles, remove entry from table  <a href="#ac7c25319f3aeb357cc37a64f3cb13b53">More...</a><br /></td></tr>
<tr class="separator:ac7c25319f3aeb357cc37a64f3cb13b53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45970f9f711d6e19c5ee03242eee5261"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a45970f9f711d6e19c5ee03242eee5261">BBCleanupProcessTable</a> ()</td></tr>
<tr class="memdesc:a45970f9f711d6e19c5ee03242eee5261"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear global process map table  <a href="#a45970f9f711d6e19c5ee03242eee5261">More...</a><br /></td></tr>
<tr class="separator:a45970f9f711d6e19c5ee03242eee5261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6678da5eb92b81e33d87f7490951007"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#ad6678da5eb92b81e33d87f7490951007">BBCleanupHostProcess</a> (IN <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a> pProcessEntry)</td></tr>
<tr class="memdesc:ad6678da5eb92b81e33d87f7490951007"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmap any mapped pages from host process  <a href="#ad6678da5eb92b81e33d87f7490951007">More...</a><br /></td></tr>
<tr class="separator:ad6678da5eb92b81e33d87f7490951007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a437717f5fe0068e8f8f6275e8c461f4b"><td class="memItemLeft" align="right" valign="top">RTL_GENERIC_COMPARE_RESULTS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a437717f5fe0068e8f8f6275e8c461f4b">AvlCompare</a> (IN RTL_AVL_TABLE *Table, IN PVOID FirstStruct, IN PVOID SecondStruct)</td></tr>
<tr class="separator:a437717f5fe0068e8f8f6275e8c461f4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88fc15832706f815eae8775b4331ac1b"><td class="memItemLeft" align="right" valign="top">PVOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a88fc15832706f815eae8775b4331ac1b">AvlAllocate</a> (IN RTL_AVL_TABLE *Table, IN CLONG ByteSize)</td></tr>
<tr class="separator:a88fc15832706f815eae8775b4331ac1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2922b8d15af96c5c1679492bf15e776"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#ae2922b8d15af96c5c1679492bf15e776">AvlFree</a> (IN RTL_AVL_TABLE *Table, IN PVOID Buffer)</td></tr>
<tr class="separator:ae2922b8d15af96c5c1679492bf15e776"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6151ff00e6a88b1ffdf4c6a6fc1924c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#a3c82361783384ad388af4ad2f95c54e6">DYNAMIC_DATA</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a6151ff00e6a88b1ffdf4c6a6fc1924c7">dynData</a></td></tr>
<tr class="separator:a6151ff00e6a88b1ffdf4c6a6fc1924c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab73cc47e1b1ffbd3b4935a2eb26cf4a9"><td class="memItemLeft" align="right" valign="top">RTL_AVL_TABLE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#ab73cc47e1b1ffbd3b4935a2eb26cf4a9">g_ProcessPageTables</a></td></tr>
<tr class="separator:ab73cc47e1b1ffbd3b4935a2eb26cf4a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16b32ee30960d149d4d4b6eec91f45fa"><td class="memItemLeft" align="right" valign="top">KGUARDED_MUTEX&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8h.html#a16b32ee30960d149d4d4b6eec91f45fa">g_globalLock</a></td></tr>
<tr class="separator:a16b32ee30960d149d4d4b6eec91f45fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a008bfa69a48a0b43e64ce2cc0bd34805"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="_remap_8h.html#a71278ae06f76b08db92a13518998119c">_ATTACHED_CONTEXT</a>  <a class="el" href="_remap_8h.html#a008bfa69a48a0b43e64ce2cc0bd34805">ATTACHED_CONTEXT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9cfddf725f2c1ecc87e0833f7e24539f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___m_a_p___e_n_t_r_y.html">_MAP_ENTRY</a>  <a class="el" href="_remap_8h.html#a9cfddf725f2c1ecc87e0833f7e24539f">MAP_ENTRY</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mapped memory region info </p>

</div>
</div>
<a class="anchor" id="aa273bd9c4061c76fe1e2b5d0c59f85dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___m_a_p___e_n_t_r_y.html">_MAP_ENTRY</a> * <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a52dc27c5e4029e2e7e3457763f7635c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___p_r_o_c_e_s_s___c_o_n_t_e_x_t.html">_PROCESS_CONTEXT</a> * <a class="el" href="_remap_8h.html#a52dc27c5e4029e2e7e3457763f7635c7">PPROCESS_CONTEXT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="afeeaf100ad47c01b3a067e5c9cb218d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___p_r_o_c_e_s_s___m_a_p___e_n_t_r_y.html">_PROCESS_MAP_ENTRY</a> * <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3041852b4d86bb70dd71221268549e6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___p_r_o_c_e_s_s___c_o_n_t_e_x_t.html">_PROCESS_CONTEXT</a>  <a class="el" href="_remap_8h.html#a3041852b4d86bb70dd71221268549e6d">PROCESS_CONTEXT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process-specific data </p>

</div>
</div>
<a class="anchor" id="a68f800b382424732b9836bc34e166eab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___p_r_o_c_e_s_s___m_a_p___e_n_t_r_y.html">_PROCESS_MAP_ENTRY</a>  <a class="el" href="_remap_8h.html#a68f800b382424732b9836bc34e166eab">PROCESS_MAP_ENTRY</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Target - host correspondence </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="a71278ae06f76b08db92a13518998119c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="_remap_8h.html#a71278ae06f76b08db92a13518998119c">_ATTACHED_CONTEXT</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a71278ae06f76b08db92a13518998119cab4687aff0f798615d03fd2fe53adf574"></a>ContextNone&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a71278ae06f76b08db92a13518998119ca59d259a461cb99f6b07d0a6448fb0b48"></a>ContextHost&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a71278ae06f76b08db92a13518998119cad47a6469246e4c609c4ffc501d973cda"></a>ContextTarget&#160;</td><td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a88fc15832706f815eae8775b4331ac1b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PVOID AvlAllocate </td>
          <td>(</td>
          <td class="paramtype">IN RTL_AVL_TABLE *&#160;</td>
          <td class="paramname"><em>Table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CLONG&#160;</td>
          <td class="paramname"><em>ByteSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a437717f5fe0068e8f8f6275e8c461f4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RTL_GENERIC_COMPARE_RESULTS AvlCompare </td>
          <td>(</td>
          <td class="paramtype">IN RTL_AVL_TABLE *&#160;</td>
          <td class="paramname"><em>Table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN PVOID&#160;</td>
          <td class="paramname"><em>FirstStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN PVOID&#160;</td>
          <td class="paramname"><em>SecondStruct</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae2922b8d15af96c5c1679492bf15e776"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a> AvlFree </td>
          <td>(</td>
          <td class="paramtype">IN RTL_AVL_TABLE *&#160;</td>
          <td class="paramname"><em>Table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN PVOID&#160;</td>
          <td class="paramname"><em>Buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad6678da5eb92b81e33d87f7490951007"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a> BBCleanupHostProcess </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a>&#160;</td>
          <td class="paramname"><em>pProcessEntry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unmap any mapped pages from host process </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pProcessEntry</td><td>Process entry</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac7c25319f3aeb357cc37a64f3cb13b53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a> BBCleanupProcessEntry </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a>&#160;</td>
          <td class="paramname"><em>pProcessEntry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unmap all regions, delete MDLs, close handles, remove entry from table </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pProcessEntry</td><td>Process entry</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a45970f9f711d6e19c5ee03242eee5261"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a> BBCleanupProcessTable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear global process map table </p>

</div>
</div>
<a class="anchor" id="a3e26085ed53a0a82250d5f519fa91e57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBGetRequiredRemapOutputSize </td>
          <td>(</td>
          <td class="paramtype">IN PLIST_ENTRY&#160;</td>
          <td class="paramname"><em>pList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT PULONG_PTR&#160;</td>
          <td class="paramname"><em>pSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate size required to store mapping info </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pList</td><td>Mapped regions list</td></tr>
    <tr><td class="paramname">pSize</td><td>Resulting size</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="ab9160b10f2c993aa5b93d95b83004a46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a> BBLookupProcessEntry </td>
          <td>(</td>
          <td class="paramtype">IN HANDLE&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN&#160;</td>
          <td class="paramname"><em>asHost</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search process entry in list by PID </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pid</td><td>PID.</td></tr>
    <tr><td class="paramname">asHost</td><td>If set to TRUE, pid is treated as host PID</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Found entry, NULL in not found</dd></dl>

</div>
</div>
<a class="anchor" id="a477ab35d84eaab6198cd8c2b36966df5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBMapMemory </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_black_bone_def_8h.html#a756d94b3d8b59bf911ebef69c31224e3">PMAP_MEMORY</a>&#160;</td>
          <td class="paramname"><em>pRemap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a> *&#160;</td>
          <td class="paramname"><em>ppEntry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map entire address space of target process into current </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pRemap</td><td>Mapping params</td></tr>
    <tr><td class="paramname">ppEntry</td><td>Mapped context</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>
<p>Map entire address space of target process into current </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pRemap</td><td>Mapping params</td></tr>
    <tr><td class="paramname">ppEntry</td><td>Mapped context</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="add6826b20572e5728507d4c040351cfd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBMapMemoryRegion </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_black_bone_def_8h.html#a1973bf123a2adca43b1411769fb6153f">PMAP_MEMORY_REGION</a>&#160;</td>
          <td class="paramname"><em>pRegion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT <a class="el" href="_black_bone_def_8h.html#a7d8cb706531527e27eccba284162b7f4">PMAP_MEMORY_REGION_RESULT</a>&#160;</td>
          <td class="paramname"><em>pResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map specific memory region </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pRegion</td><td>Region data</td></tr>
    <tr><td class="paramname">pResult</td><td>Mapping results</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a1cb21cac2fa196ad5abff8a9e90baee7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBUnmapMemory </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_black_bone_def_8h.html#aee5703b358f0279a38c1469f5126af8d">PUNMAP_MEMORY</a>&#160;</td>
          <td class="paramname"><em>pUnmap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unmap any mapped memory from host and target processes </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pUnmap</td><td>Request params</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a10ed588f0df58d216e8593eb5e4a686f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBUnmapMemoryRegion </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_black_bone_def_8h.html#abe98aab52e6513851c7238d73233ba5e">PUNMAP_MEMORY_REGION</a>&#160;</td>
          <td class="paramname"><em>pRegion</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unmap specific memory region </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pRegion</td><td>Region info</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status ode</dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a6151ff00e6a88b1ffdf4c6a6fc1924c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#a3c82361783384ad388af4ad2f95c54e6">DYNAMIC_DATA</a> dynData</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a16b32ee30960d149d4d4b6eec91f45fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KGUARDED_MUTEX g_globalLock</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab73cc47e1b1ffbd3b4935a2eb26cf4a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RTL_AVL_TABLE g_ProcessPageTables</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_1be4885ae0f8fc825ada64c048101ff4.html">Visual Studio 2013</a></li><li class="navelem"><a class="el" href="dir_cff6504ebdd213a64976c6fc552b82ee.html">Projects</a></li><li class="navelem"><a class="el" href="dir_b716da8d3aa0fe4ae2f6139a1f666f87.html">BlackBone</a></li><li class="navelem"><a class="el" href="dir_ad2d131fed674adc088bc470bbb2e438.html">src</a></li><li class="navelem"><a class="el" href="dir_ddc31af3ab12d58410e17a5b1105cec8.html">BlackBoneDrv</a></li><li class="navelem"><a class="el" href="_remap_8h.html">Remap.h</a></li>
    <li class="footer">Generated on Tue Sep 23 2014 11:50:44 for BlackBone by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
