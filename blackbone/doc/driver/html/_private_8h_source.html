<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>BlackBone: C:/Users/Ton/Documents/Visual Studio 2013/Projects/BlackBone/src/BlackBoneDrv/Private.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BlackBone
   </div>
   <div id="projectbrief">Windows memory hacking library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_private_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Private.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_private_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_imports_8h.html">Imports.h</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#ifdef DBG</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#define DPRINT(format, ...) DbgPrintEx(DPFLTR_IHVDRIVER_ID, DPFLTR_ERROR_LEVEL, format, __VA_ARGS__)</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="_private_8h.html#a57a35bfd7d13bdfab37a48171286ecee">    8</a></span>&#160;<span class="preprocessor">#define DPRINT(...)</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="_private_8h.html#ab83381de72db4f5d852ba26949e2902e">   11</a></span>&#160;<span class="preprocessor">#define BB_POOL_TAG &#39;enoB&#39;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="_private_8h.html#ac0e7cabf39139335ab2a08cfa43d5d8c">   14</a></span>&#160;<span class="preprocessor">#define ObpAccessProtectCloseBit 0x2000000</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// PTE protection values</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="_private_8h.html#ab5e3b8db4907611da490b4a03db78c1e">   19</a></span>&#160;<span class="preprocessor">#define MM_ZERO_ACCESS         0</span></div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="_private_8h.html#a1dc55d9dd65edc8ea00f5f5b53fa8766">   20</a></span>&#160;<span class="preprocessor">#define MM_READONLY            1</span></div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="_private_8h.html#a8852a624292316b648b0ff9e28fe2f38">   21</a></span>&#160;<span class="preprocessor">#define MM_EXECUTE             2</span></div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="_private_8h.html#a95a6abe4773c1a895cc70e369629134a">   22</a></span>&#160;<span class="preprocessor">#define MM_EXECUTE_READ        3</span></div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="_private_8h.html#a15b480960d8ee5301b76872e240b39aa">   23</a></span>&#160;<span class="preprocessor">#define MM_READWRITE           4</span></div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="_private_8h.html#af728327a8e1f6228d15e1480d11dfce5">   24</a></span>&#160;<span class="preprocessor">#define MM_WRITECOPY           5</span></div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="_private_8h.html#a5d2df44b21032afeff377273bbcb7afd">   25</a></span>&#160;<span class="preprocessor">#define MM_EXECUTE_READWRITE   6</span></div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="_private_8h.html#a06ae721e86124dd670d6faed0f241c71">   26</a></span>&#160;<span class="preprocessor">#define MM_EXECUTE_WRITECOPY   7</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="_private_8h.html#ab45ab10fa5d1c8b2f64ce77f2a50bf71">   28</a></span>&#160;<span class="preprocessor">#define MM_PTE_VALID_MASK         0x1</span></div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="_private_8h.html#a247d6c411e171ec2f15ecafbb83cefaf">   29</a></span>&#160;<span class="preprocessor">#define MM_PTE_WRITE_MASK         0x800</span></div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="_private_8h.html#a1f06e24261afa3694896294bc037326c">   30</a></span>&#160;<span class="preprocessor">#define MM_PTE_OWNER_MASK         0x4</span></div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="_private_8h.html#a9d5a764fa39ad7b90cf84f0d32bdf82b">   31</a></span>&#160;<span class="preprocessor">#define MM_PTE_WRITE_THROUGH_MASK 0x8</span></div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="_private_8h.html#af42bd165038436553166561d4870c9de">   32</a></span>&#160;<span class="preprocessor">#define MM_PTE_CACHE_DISABLE_MASK 0x10</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="_private_8h.html#a3da2a4f9cde1c340cde043805c038192">   33</a></span>&#160;<span class="preprocessor">#define MM_PTE_ACCESS_MASK        0x20</span></div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="_private_8h.html#a2e6835ffe04b45099c5072afa74f8376">   34</a></span>&#160;<span class="preprocessor">#define MM_PTE_DIRTY_MASK         0x42</span></div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="_private_8h.html#a0e1c8d5f91c948fb5ecbc57e0d9030ee">   35</a></span>&#160;<span class="preprocessor">#define MM_PTE_LARGE_PAGE_MASK    0x80</span></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="_private_8h.html#a187af98f8f73581fb6a9d0843f35fbb5">   36</a></span>&#160;<span class="preprocessor">#define MM_PTE_GLOBAL_MASK        0x100</span></div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="_private_8h.html#a569ba76eb0a587ab837ac34e06a7efa5">   37</a></span>&#160;<span class="preprocessor">#define MM_PTE_COPY_ON_WRITE_MASK 0x200</span></div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="_private_8h.html#ac233a0706417dfab5ec09f7d19badda2">   38</a></span>&#160;<span class="preprocessor">#define MM_PTE_PROTOTYPE_MASK     0x400</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="_private_8h.html#afd89f8ce9b2074738a2b875c8491a4d9">   39</a></span>&#160;<span class="preprocessor">#define MM_PTE_TRANSITION_MASK    0x800</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="_private_8h.html#a6619d450b6001362ec4fafbce4e69f5e">   41</a></span>&#160;<span class="preprocessor">#define VIRTUAL_ADDRESS_BITS 48</span></div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="_private_8h.html#aeb992b95ae1285628a9d803ef754713d">   42</a></span>&#160;<span class="preprocessor">#define VIRTUAL_ADDRESS_MASK ((((ULONG_PTR)1) &lt;&lt; VIRTUAL_ADDRESS_BITS) - 1)</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="_private_8h.html#acc114e5425c7a947e44503367cd761ea">   44</a></span>&#160;<span class="preprocessor">#define THREAD_CREATE_FLAGS_CREATE_SUSPENDED        0x00000001</span></div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="_private_8h.html#a5b3ba22c7f1a1d953e29c0ee74f5e1a2">   45</a></span>&#160;<span class="preprocessor">#define THREAD_CREATE_FLAGS_SKIP_THREAD_ATTACH      0x00000002</span></div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="_private_8h.html#a96c3c68a3dc46ef65d58e26b70f0fce2">   46</a></span>&#160;<span class="preprocessor">#define THREAD_CREATE_FLAGS_HIDE_FROM_DEBUGGER      0x00000004</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="_private_8h.html#a15f582d71764933117dde2a424995a2f">   48</a></span>&#160;<span class="preprocessor">#define PTE_SHIFT 3</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="_private_8h.html#a32cbc52ab33e9f4f88e12c01c7c886fc">   49</a></span>&#160;<span class="preprocessor">#define ObpDecodeGrantedAccess( Access ) \</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">    ((Access)&amp; ~ObpAccessProtectCloseBit)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="_private_8h.html#a87c8ba47c1a22918dd8f3d41df86309f">   52</a></span>&#160;<span class="preprocessor">#define ObpDecodeObject( Object ) (PVOID)(((LONG_PTR)Object &gt;&gt; 0x10) &amp; ~(ULONG_PTR)0xF)</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="_private_8h.html#ae4d8429e799c3a96238fae71b9001841">   54</a></span>&#160;<span class="preprocessor">#define MiGetPxeOffset(va) \</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">    ((ULONG)(((ULONG_PTR)(va) &gt;&gt; PXI_SHIFT) &amp; PXI_MASK))</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="_private_8h.html#aca12c17b8b783f40c08a65036dfa7b03">   57</a></span>&#160;<span class="preprocessor">#define MiGetPxeAddress(va)   \</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">    ((PMMPTE)PXE_BASE + MiGetPxeOffset(va))</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="_private_8h.html#af52ec2472252e84d3317777ecca3375d">   60</a></span>&#160;<span class="preprocessor">#define MiGetPpeAddress(va)   \</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">    ((PMMPTE)(((((ULONG_PTR)(va) &amp; VIRTUAL_ADDRESS_MASK) &gt;&gt; PPI_SHIFT) &lt;&lt; PTE_SHIFT) + PPE_BASE))</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="_private_8h.html#a53abc747ab1b753b2e3610968a7531d3">   63</a></span>&#160;<span class="preprocessor">#define MiGetPdeAddress(va) \</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">    ((PMMPTE)(((((ULONG_PTR)(va) &amp; VIRTUAL_ADDRESS_MASK) &gt;&gt; PDI_SHIFT) &lt;&lt; PTE_SHIFT) + PDE_BASE))</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="_private_8h.html#a37d026c23197d996a6ac9df06c0dd3c1">   66</a></span>&#160;<span class="preprocessor">#define MiGetPteAddress(va) \</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">    ((PMMPTE)(((((ULONG_PTR)(va) &amp; VIRTUAL_ADDRESS_MASK) &gt;&gt; PTI_SHIFT) &lt;&lt; PTE_SHIFT) + PTE_BASE))</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="_private_8h.html#a33b1753e7720ff59b9f68387fe2aeff6">   69</a></span>&#160;<span class="preprocessor">#define VA_SHIFT (63 - 47)              // address sign extend shift count</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="_private_8h.html#a7b86d7101cf859cdaaef6fe108a421c6">   71</a></span>&#160;<span class="preprocessor">#define MiGetVirtualAddressMappedByPte(PTE) \</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">    ((PVOID)((LONG_PTR)(((LONG_PTR)(PTE) - PTE_BASE) &lt;&lt; (PAGE_SHIFT + VA_SHIFT - PTE_SHIFT)) &gt;&gt; VA_SHIFT))</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="_private_8h.html#af54c9abc6e56d2f299c35e587f843c3e">   74</a></span>&#160;<span class="preprocessor">#define MI_IS_PHYSICAL_ADDRESS(Va) \</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">    ((MiGetPxeAddress(Va)-&gt;u.Hard.Valid == 1) &amp;&amp; \</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">     (MiGetPpeAddress(Va)-&gt;u.Hard.Valid == 1) &amp;&amp; \</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">     ((MiGetPdeAddress(Va)-&gt;u.Long &amp; 0x81) == 0x81) || (MiGetPteAddress(Va)-&gt;u.Hard.Valid == 1))</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="_private_8h.html#a0315b890ecae79daf990c135eb972f61">   79</a></span>&#160;<span class="keyword">typedef</span> ULONG <a class="code" href="_private_8h.html#a0315b890ecae79daf990c135eb972f61">WIN32_PROTECTION_MASK</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="_private_8h.html#a5226798f3e4415420d8e4e33adc0638f">   80</a></span>&#160;<span class="keyword">typedef</span> PULONG <a class="code" href="_private_8h.html#a5226798f3e4415420d8e4e33adc0638f">PWIN32_PROTECTION_MASK</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="_private_8h.html#aec75812efdf2df26c3b39044237794aa">   82</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="_private_8h.html#aec75812efdf2df26c3b39044237794aa">_WinVer</a></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="_private_8h.html#aec75812efdf2df26c3b39044237794aaafcddc62a0fdd3bc4db5b3494cb41b877">   84</a></span>&#160;    <a class="code" href="_private_8h.html#aec75812efdf2df26c3b39044237794aaafcddc62a0fdd3bc4db5b3494cb41b877">WINVER_7</a>     = 0x610,</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="_private_8h.html#aec75812efdf2df26c3b39044237794aaae17b1f645209d73b0ee9332ba5ad5bcc">   85</a></span>&#160;    <a class="code" href="_private_8h.html#aec75812efdf2df26c3b39044237794aaae17b1f645209d73b0ee9332ba5ad5bcc">WINVER_7_SP1</a> = 0x611,</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="_private_8h.html#aec75812efdf2df26c3b39044237794aaa89b2f13a59851dd125d2f5979fab6d19">   86</a></span>&#160;    <a class="code" href="_private_8h.html#aec75812efdf2df26c3b39044237794aaa89b2f13a59851dd125d2f5979fab6d19">WINVER_8</a>     = 0x620,</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="_private_8h.html#aec75812efdf2df26c3b39044237794aaa58538d1ebe1d9d6ff74fedf607299fb7">   87</a></span>&#160;    <a class="code" href="_private_8h.html#aec75812efdf2df26c3b39044237794aaa58538d1ebe1d9d6ff74fedf607299fb7">WINVER_81</a>    = 0x630,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;} <a class="code" href="_private_8h.html#ac9cfc5738ea3990637e2464b1fd7e908">WinVer</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">extern</span> PLIST_ENTRY <a class="code" href="_private_8h.html#a921919ecbd45a31fc4593d1c8067113c">PsLoadedModuleList</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">extern</span> <a class="code" href="struct___m_m_p_t_e.html">MMPTE</a> <a class="code" href="_private_8h.html#a0353aa086bb1eb13d7bbc8b717b72303">ValidKernelPte</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="struct___d_y_n_a_m_i_c___d_a_t_a.html">   96</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct___d_y_n_a_m_i_c___d_a_t_a.html">_DYNAMIC_DATA</a></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a7c20b1b98814bcb31ff8f53bedd64f06">   98</a></span>&#160;    <a class="code" href="_private_8h.html#ac9cfc5738ea3990637e2464b1fd7e908">WinVer</a> <a class="code" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a7c20b1b98814bcb31ff8f53bedd64f06">ver</a>;             <span class="comment">// OS version</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#ab9cc96d4ac961191e931db74b923c1c6">  100</a></span>&#160;    ULONG <a class="code" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#ab9cc96d4ac961191e931db74b923c1c6">KExecOpt</a>;         <span class="comment">// KEXECUTE_OPTIONS offset in KPROCESS</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a0272ed391345bdb24a45cf9c0dd5a986">  101</a></span>&#160;    ULONG <a class="code" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a0272ed391345bdb24a45cf9c0dd5a986">Protection</a>;       <span class="comment">// Process protection flag offset in EPROCESS</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a98727f453ec55adc3deca10010a6219e">  102</a></span>&#160;    ULONG <a class="code" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a98727f453ec55adc3deca10010a6219e">ObjTable</a>;         <span class="comment">// Process handle table offset in EPROCESS</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a7e772846599ada1c7431c1df8d868d4a">  103</a></span>&#160;    ULONG <a class="code" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a7e772846599ada1c7431c1df8d868d4a">VadRoot</a>;          <span class="comment">// VadRoot offset in EPROCESS</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a9c9632ef640aa31fbd064c8c05e29768">  104</a></span>&#160;    ULONG <a class="code" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a9c9632ef640aa31fbd064c8c05e29768">NtProtectIndex</a>;   <span class="comment">// NtProtectVirtualMemory SSDT index</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a04a20c6201627cb2b0ef2a8c9149e5c5">  105</a></span>&#160;    ULONG <a class="code" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a04a20c6201627cb2b0ef2a8c9149e5c5">NtThdIndex</a>;       <span class="comment">// NtCreateThreadEx SSDT index</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a392bcf8c9d28b16a4d4ddcbf9ffa9e43">  106</a></span>&#160;    ULONG <a class="code" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a392bcf8c9d28b16a4d4ddcbf9ffa9e43">PrevMode</a>;         <span class="comment">// PreviousMode offset in KTHREAD</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#ab68f70a4a6118812b105fb84312ea879">  107</a></span>&#160;    ULONG <a class="code" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#ab68f70a4a6118812b105fb84312ea879">ExitStatus</a>;       <span class="comment">// ETHREAD ExitStatus field</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a8e2fcf261b863fd2f657c4fdaf4124ab">  108</a></span>&#160;    ULONG <a class="code" href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a8e2fcf261b863fd2f657c4fdaf4124ab">MiAllocPage</a>;      <span class="comment">// MiAllocateDriver page offset</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;} <a class="code" href="_private_8h.html#a3c82361783384ad388af4ad2f95c54e6">DYNAMIC_DATA</a>, *<a class="code" href="_private_8h.html#abc9038b35dee6f23108c8b73c50b38f1">PDYNAMIC_DATA</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keyword">typedef</span> <a class="code" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>( NTAPI* fnNtCreateThreadEx )</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    (</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        OUT PHANDLE hThread,</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="_private_8h.html#add1e20658dc57efce900e27d0da82042">  115</a></span>&#160;        IN ACCESS_MASK <a class="code" href="_private_8h.html#a505c81a103cfd0b7b641a73c32278667">DesiredAccess</a>,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        IN PVOID <a class="code" href="_private_8h.html#aaca62831963978eed52c5d98d58a164b">ObjectAttributes</a>,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        IN HANDLE <a class="code" href="_private_8h.html#aa7beabc7665214e8fd2afb44492b58b1">ProcessHandle</a>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        IN PVOID <a class="code" href="_private_8h.html#a94462919ddf277e2e6a701999b13cf0c">lpStartAddress</a>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        IN PVOID <a class="code" href="_private_8h.html#a131902a6d3762d7dbe6ce5c00d3bb890">lpParameter</a>,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        IN ULONG <a class="code" href="_private_8h.html#a29f471bf36d8e7a4ff099cc11afaad2c">Flags</a>,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        IN SIZE_T <a class="code" href="_private_8h.html#add1e20658dc57efce900e27d0da82042">StackZeroBits</a>,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        IN SIZE_T <a class="code" href="_private_8h.html#a823253fd4f06f8d17de90cd8a7e91b17">SizeOfStackCommit</a>,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        IN SIZE_T <a class="code" href="_private_8h.html#ad1fb06eb703def1806da910e1ce9bc85">SizeOfStackReserve</a>,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        OUT PVOID <a class="code" href="_private_8h.html#a957e69fb57b51a976612ece6e7306d6d">lpBytesBuffer</a></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    );</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keyword">typedef</span> <a class="code" href="_private_8h.html#ae6feab6633ff0f12fef77e635f020a99">PFN_NUMBER</a>( NTAPI* fnMiAllocateDriverPage )(<a class="code" href="struct___m_m_p_t_e.html">PMMPTE</a> pPTE);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#if defined(_WIN8_) || defined (_WIN7_)</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">typedef</span> <a class="code" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>( NTAPI* fnNtProtectVirtualMemory )</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    ( </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        IN HANDLE <a class="code" href="_private_8h.html#aa7beabc7665214e8fd2afb44492b58b1">ProcessHandle</a>,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        IN PVOID* BaseAddress,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        IN SIZE_T* NumberOfBytesToProtect,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        IN ULONG NewAccessProtection,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        OUT PULONG OldAccessProtection</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    );</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<a class="code" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;NTAPI</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<a class="code" href="_private_8h.html#abefaba0523fed35eabd6e1724df15c84">ZwProtectVirtualMemory</a>(</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    IN HANDLE <a class="code" href="_private_8h.html#aa7beabc7665214e8fd2afb44492b58b1">ProcessHandle</a>,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    IN PVOID* BaseAddress,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    IN SIZE_T* NumberOfBytesToProtect,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    IN ULONG NewAccessProtection,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    OUT PULONG OldAccessProtection </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    );</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;NTSYSAPI</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<a class="code" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;NTAPI</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<a class="code" href="_private_8h.html#abefaba0523fed35eabd6e1724df15c84">ZwProtectVirtualMemory</a>( </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    IN HANDLE <a class="code" href="_private_8h.html#aa7beabc7665214e8fd2afb44492b58b1">ProcessHandle</a>,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    IN PVOID* BaseAddress,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    IN SIZE_T* NumberOfBytesToProtect,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    IN ULONG NewAccessProtection,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    OUT PULONG OldAccessProtection</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    );</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">#ifdef _WIN81_</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;NTSYSAPI </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;PVOID </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;NTAPI </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;RtlAvlRemoveNode( </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    IN <a class="code" href="struct___r_t_l___a_v_l___t_r_e_e.html">PRTL_AVL_TREE</a> pTree, </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    IN <a class="code" href="struct___m_m_a_d_d_r_e_s_s___n_o_d_e.html">PMMADDRESS_NODE</a> pNode </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    );</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<a class="code" href="struct___h_a_n_d_l_e___t_a_b_l_e___e_n_t_r_y.html">PHANDLE_TABLE_ENTRY</a> <a class="code" href="_private_8h.html#a10f0aa16e7e2572dcdc7427b1db8f561">ExpLookupHandleTableEntry</a>( IN <a class="code" href="struct___h_a_n_d_l_e___t_a_b_l_e.html">PHANDLE_TABLE</a> HandleTable, IN <a class="code" href="union___e_x_h_a_n_d_l_e.html">EXHANDLE</a> tHandle );</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;PVOID <a class="code" href="_private_8h.html#a4703a8b2c58a435905c03f7c50e95a8d">GetKernelBase</a>();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;PVOID <a class="code" href="_private_8h.html#a53964917cc418781435d0d9307a119fe">GetSSDTBase</a>();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;PVOID <a class="code" href="_private_8h.html#a69b865e9a10a8622707f63d838ad07fe">GetSSDTEntry</a>( IN ULONG index );</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<a class="code" href="struct___m_m_p_t_e.html">PMMPTE</a> <a class="code" href="_private_8h.html#a12e4266a6f1a04f2b43f7df9281afe16">GetPTEForVA</a>( IN PVOID pAddress );</div>
<div class="ttc" id="union___e_x_h_a_n_d_l_e_html"><div class="ttname"><a href="union___e_x_h_a_n_d_l_e.html">_EXHANDLE</a></div><div class="ttdef"><b>Definition:</b> NativeStructs.h:44</div></div>
<div class="ttc" id="_private_8h_html_a921919ecbd45a31fc4593d1c8067113c"><div class="ttname"><a href="_private_8h.html#a921919ecbd45a31fc4593d1c8067113c">PsLoadedModuleList</a></div><div class="ttdeci">PLIST_ENTRY PsLoadedModuleList</div><div class="ttdef"><b>Definition:</b> Loader.c:7</div></div>
<div class="ttc" id="struct___d_y_n_a_m_i_c___d_a_t_a_html"><div class="ttname"><a href="struct___d_y_n_a_m_i_c___d_a_t_a.html">_DYNAMIC_DATA</a></div><div class="ttdoc">OS-dependent stuff </div><div class="ttdef"><b>Definition:</b> Private.h:96</div></div>
<div class="ttc" id="_private_8h_html_a957e69fb57b51a976612ece6e7306d6d"><div class="ttname"><a href="_private_8h.html#a957e69fb57b51a976612ece6e7306d6d">lpBytesBuffer</a></div><div class="ttdeci">IN ACCESS_MASK IN PVOID IN HANDLE IN PVOID IN PVOID IN ULONG IN SIZE_T IN SIZE_T IN SIZE_T OUT PVOID lpBytesBuffer</div><div class="ttdef"><b>Definition:</b> Private.h:115</div></div>
<div class="ttc" id="struct___h_a_n_d_l_e___t_a_b_l_e___e_n_t_r_y_html"><div class="ttname"><a href="struct___h_a_n_d_l_e___t_a_b_l_e___e_n_t_r_y.html">_HANDLE_TABLE_ENTRY</a></div><div class="ttdef"><b>Definition:</b> NativeStructs.h:58</div></div>
<div class="ttc" id="struct___d_y_n_a_m_i_c___d_a_t_a_html_a0272ed391345bdb24a45cf9c0dd5a986"><div class="ttname"><a href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a0272ed391345bdb24a45cf9c0dd5a986">_DYNAMIC_DATA::Protection</a></div><div class="ttdeci">ULONG Protection</div><div class="ttdef"><b>Definition:</b> Private.h:101</div></div>
<div class="ttc" id="_private_8h_html_aec75812efdf2df26c3b39044237794aaafcddc62a0fdd3bc4db5b3494cb41b877"><div class="ttname"><a href="_private_8h.html#aec75812efdf2df26c3b39044237794aaafcddc62a0fdd3bc4db5b3494cb41b877">WINVER_7</a></div><div class="ttdef"><b>Definition:</b> Private.h:84</div></div>
<div class="ttc" id="_private_8h_html_a0353aa086bb1eb13d7bbc8b717b72303"><div class="ttname"><a href="_private_8h.html#a0353aa086bb1eb13d7bbc8b717b72303">ValidKernelPte</a></div><div class="ttdeci">MMPTE ValidKernelPte</div><div class="ttdef"><b>Definition:</b> Private.c:15</div></div>
<div class="ttc" id="struct___h_a_n_d_l_e___t_a_b_l_e_html"><div class="ttname"><a href="struct___h_a_n_d_l_e___t_a_b_l_e.html">_HANDLE_TABLE</a></div><div class="ttdef"><b>Definition:</b> NativeStructs.h:100</div></div>
<div class="ttc" id="struct___d_y_n_a_m_i_c___d_a_t_a_html_a392bcf8c9d28b16a4d4ddcbf9ffa9e43"><div class="ttname"><a href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a392bcf8c9d28b16a4d4ddcbf9ffa9e43">_DYNAMIC_DATA::PrevMode</a></div><div class="ttdeci">ULONG PrevMode</div><div class="ttdef"><b>Definition:</b> Private.h:106</div></div>
<div class="ttc" id="_private_8h_html_a53964917cc418781435d0d9307a119fe"><div class="ttname"><a href="_private_8h.html#a53964917cc418781435d0d9307a119fe">GetSSDTBase</a></div><div class="ttdeci">PVOID GetSSDTBase()</div><div class="ttdoc">Gets SSDT base - KiSystemServiceTable </div><div class="ttdef"><b>Definition:</b> Private.c:123</div></div>
<div class="ttc" id="_private_8h_html_add1e20658dc57efce900e27d0da82042"><div class="ttname"><a href="_private_8h.html#add1e20658dc57efce900e27d0da82042">StackZeroBits</a></div><div class="ttdeci">IN ACCESS_MASK IN PVOID IN HANDLE IN PVOID IN PVOID IN ULONG IN SIZE_T StackZeroBits</div><div class="ttdef"><b>Definition:</b> Private.h:115</div></div>
<div class="ttc" id="_private_8h_html_afa7140c76ae020a5271b3181ccb8b512"><div class="ttname"><a href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a></div><div class="ttdeci">typedef NTSTATUS(NTAPI *fnNtCreateThreadEx)(OUT PHANDLE hThread</div></div>
<div class="ttc" id="struct___d_y_n_a_m_i_c___d_a_t_a_html_a9c9632ef640aa31fbd064c8c05e29768"><div class="ttname"><a href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a9c9632ef640aa31fbd064c8c05e29768">_DYNAMIC_DATA::NtProtectIndex</a></div><div class="ttdeci">ULONG NtProtectIndex</div><div class="ttdef"><b>Definition:</b> Private.h:104</div></div>
<div class="ttc" id="_private_8h_html_a131902a6d3762d7dbe6ce5c00d3bb890"><div class="ttname"><a href="_private_8h.html#a131902a6d3762d7dbe6ce5c00d3bb890">lpParameter</a></div><div class="ttdeci">IN ACCESS_MASK IN PVOID IN HANDLE IN PVOID IN PVOID lpParameter</div><div class="ttdef"><b>Definition:</b> Private.h:115</div></div>
<div class="ttc" id="_private_8h_html_aec75812efdf2df26c3b39044237794aaae17b1f645209d73b0ee9332ba5ad5bcc"><div class="ttname"><a href="_private_8h.html#aec75812efdf2df26c3b39044237794aaae17b1f645209d73b0ee9332ba5ad5bcc">WINVER_7_SP1</a></div><div class="ttdef"><b>Definition:</b> Private.h:85</div></div>
<div class="ttc" id="_private_8h_html_a10f0aa16e7e2572dcdc7427b1db8f561"><div class="ttname"><a href="_private_8h.html#a10f0aa16e7e2572dcdc7427b1db8f561">ExpLookupHandleTableEntry</a></div><div class="ttdeci">PHANDLE_TABLE_ENTRY ExpLookupHandleTableEntry(IN PHANDLE_TABLE HandleTable, IN EXHANDLE tHandle)</div><div class="ttdoc">Lookup handle in the process handle table </div><div class="ttdef"><b>Definition:</b> Private.c:28</div></div>
<div class="ttc" id="_private_8h_html_abefaba0523fed35eabd6e1724df15c84"><div class="ttname"><a href="_private_8h.html#abefaba0523fed35eabd6e1724df15c84">ZwProtectVirtualMemory</a></div><div class="ttdeci">NTSYSAPI NTSTATUS NTAPI ZwProtectVirtualMemory(IN HANDLE ProcessHandle, IN PVOID *BaseAddress, IN SIZE_T *NumberOfBytesToProtect, IN ULONG NewAccessProtection, OUT PULONG OldAccessProtection)</div></div>
<div class="ttc" id="struct___d_y_n_a_m_i_c___d_a_t_a_html_ab68f70a4a6118812b105fb84312ea879"><div class="ttname"><a href="struct___d_y_n_a_m_i_c___d_a_t_a.html#ab68f70a4a6118812b105fb84312ea879">_DYNAMIC_DATA::ExitStatus</a></div><div class="ttdeci">ULONG ExitStatus</div><div class="ttdef"><b>Definition:</b> Private.h:107</div></div>
<div class="ttc" id="struct___d_y_n_a_m_i_c___d_a_t_a_html_a04a20c6201627cb2b0ef2a8c9149e5c5"><div class="ttname"><a href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a04a20c6201627cb2b0ef2a8c9149e5c5">_DYNAMIC_DATA::NtThdIndex</a></div><div class="ttdeci">ULONG NtThdIndex</div><div class="ttdef"><b>Definition:</b> Private.h:105</div></div>
<div class="ttc" id="_private_8h_html_abc9038b35dee6f23108c8b73c50b38f1"><div class="ttname"><a href="_private_8h.html#abc9038b35dee6f23108c8b73c50b38f1">PDYNAMIC_DATA</a></div><div class="ttdeci">struct _DYNAMIC_DATA * PDYNAMIC_DATA</div></div>
<div class="ttc" id="_private_8h_html_ae6feab6633ff0f12fef77e635f020a99"><div class="ttname"><a href="_private_8h.html#ae6feab6633ff0f12fef77e635f020a99">PFN_NUMBER</a></div><div class="ttdeci">typedef PFN_NUMBER(NTAPI *fnMiAllocateDriverPage)(PMMPTE pPTE)</div></div>
<div class="ttc" id="_private_8h_html_aec75812efdf2df26c3b39044237794aa"><div class="ttname"><a href="_private_8h.html#aec75812efdf2df26c3b39044237794aa">_WinVer</a></div><div class="ttdeci">_WinVer</div><div class="ttdef"><b>Definition:</b> Private.h:82</div></div>
<div class="ttc" id="_private_8h_html_ad1fb06eb703def1806da910e1ce9bc85"><div class="ttname"><a href="_private_8h.html#ad1fb06eb703def1806da910e1ce9bc85">SizeOfStackReserve</a></div><div class="ttdeci">IN ACCESS_MASK IN PVOID IN HANDLE IN PVOID IN PVOID IN ULONG IN SIZE_T IN SIZE_T IN SIZE_T SizeOfStackReserve</div><div class="ttdef"><b>Definition:</b> Private.h:115</div></div>
<div class="ttc" id="_private_8h_html_aec75812efdf2df26c3b39044237794aaa89b2f13a59851dd125d2f5979fab6d19"><div class="ttname"><a href="_private_8h.html#aec75812efdf2df26c3b39044237794aaa89b2f13a59851dd125d2f5979fab6d19">WINVER_8</a></div><div class="ttdef"><b>Definition:</b> Private.h:86</div></div>
<div class="ttc" id="_private_8h_html_a5226798f3e4415420d8e4e33adc0638f"><div class="ttname"><a href="_private_8h.html#a5226798f3e4415420d8e4e33adc0638f">PWIN32_PROTECTION_MASK</a></div><div class="ttdeci">PULONG PWIN32_PROTECTION_MASK</div><div class="ttdef"><b>Definition:</b> Private.h:80</div></div>
<div class="ttc" id="_private_8h_html_aa7beabc7665214e8fd2afb44492b58b1"><div class="ttname"><a href="_private_8h.html#aa7beabc7665214e8fd2afb44492b58b1">ProcessHandle</a></div><div class="ttdeci">IN ACCESS_MASK IN PVOID IN HANDLE ProcessHandle</div><div class="ttdef"><b>Definition:</b> Private.h:115</div></div>
<div class="ttc" id="_private_8h_html_a94462919ddf277e2e6a701999b13cf0c"><div class="ttname"><a href="_private_8h.html#a94462919ddf277e2e6a701999b13cf0c">lpStartAddress</a></div><div class="ttdeci">IN ACCESS_MASK IN PVOID IN HANDLE IN PVOID lpStartAddress</div><div class="ttdef"><b>Definition:</b> Private.h:115</div></div>
<div class="ttc" id="struct___r_t_l___a_v_l___t_r_e_e_html"><div class="ttname"><a href="struct___r_t_l___a_v_l___t_r_e_e.html">_RTL_AVL_TREE</a></div><div class="ttdef"><b>Definition:</b> NativeStructs81.h:24</div></div>
<div class="ttc" id="struct___d_y_n_a_m_i_c___d_a_t_a_html_a7e772846599ada1c7431c1df8d868d4a"><div class="ttname"><a href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a7e772846599ada1c7431c1df8d868d4a">_DYNAMIC_DATA::VadRoot</a></div><div class="ttdeci">ULONG VadRoot</div><div class="ttdef"><b>Definition:</b> Private.h:103</div></div>
<div class="ttc" id="_private_8h_html_aec75812efdf2df26c3b39044237794aaa58538d1ebe1d9d6ff74fedf607299fb7"><div class="ttname"><a href="_private_8h.html#aec75812efdf2df26c3b39044237794aaa58538d1ebe1d9d6ff74fedf607299fb7">WINVER_81</a></div><div class="ttdef"><b>Definition:</b> Private.h:87</div></div>
<div class="ttc" id="struct___m_m_p_t_e_html"><div class="ttname"><a href="struct___m_m_p_t_e.html">_MMPTE</a></div><div class="ttdef"><b>Definition:</b> NativeStructs.h:281</div></div>
<div class="ttc" id="_private_8h_html_a29f471bf36d8e7a4ff099cc11afaad2c"><div class="ttname"><a href="_private_8h.html#a29f471bf36d8e7a4ff099cc11afaad2c">Flags</a></div><div class="ttdeci">IN ACCESS_MASK IN PVOID IN HANDLE IN PVOID IN PVOID IN ULONG Flags</div><div class="ttdef"><b>Definition:</b> Private.h:115</div></div>
<div class="ttc" id="_imports_8h_html"><div class="ttname"><a href="_imports_8h.html">Imports.h</a></div></div>
<div class="ttc" id="_private_8h_html_a0315b890ecae79daf990c135eb972f61"><div class="ttname"><a href="_private_8h.html#a0315b890ecae79daf990c135eb972f61">WIN32_PROTECTION_MASK</a></div><div class="ttdeci">ULONG WIN32_PROTECTION_MASK</div><div class="ttdef"><b>Definition:</b> Private.h:79</div></div>
<div class="ttc" id="struct___d_y_n_a_m_i_c___d_a_t_a_html_a8e2fcf261b863fd2f657c4fdaf4124ab"><div class="ttname"><a href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a8e2fcf261b863fd2f657c4fdaf4124ab">_DYNAMIC_DATA::MiAllocPage</a></div><div class="ttdeci">ULONG MiAllocPage</div><div class="ttdef"><b>Definition:</b> Private.h:108</div></div>
<div class="ttc" id="_private_8h_html_aaca62831963978eed52c5d98d58a164b"><div class="ttname"><a href="_private_8h.html#aaca62831963978eed52c5d98d58a164b">ObjectAttributes</a></div><div class="ttdeci">IN ACCESS_MASK IN PVOID ObjectAttributes</div><div class="ttdef"><b>Definition:</b> Private.h:115</div></div>
<div class="ttc" id="_private_8h_html_a69b865e9a10a8622707f63d838ad07fe"><div class="ttname"><a href="_private_8h.html#a69b865e9a10a8622707f63d838ad07fe">GetSSDTEntry</a></div><div class="ttdeci">PVOID GetSSDTEntry(IN ULONG index)</div><div class="ttdoc">Gets the SSDT entry address by index. </div><div class="ttdef"><b>Definition:</b> Private.c:174</div></div>
<div class="ttc" id="_private_8h_html_a12e4266a6f1a04f2b43f7df9281afe16"><div class="ttname"><a href="_private_8h.html#a12e4266a6f1a04f2b43f7df9281afe16">GetPTEForVA</a></div><div class="ttdeci">PMMPTE GetPTEForVA(IN PVOID pAddress)</div><div class="ttdoc">Get page hardware PTE Address must be valid, otherwise bug check is imminent </div><div class="ttdef"><b>Definition:</b> Private.c:191</div></div>
<div class="ttc" id="_private_8h_html_a4703a8b2c58a435905c03f7c50e95a8d"><div class="ttname"><a href="_private_8h.html#a4703a8b2c58a435905c03f7c50e95a8d">GetKernelBase</a></div><div class="ttdeci">PVOID GetKernelBase()</div><div class="ttdoc">Get ntoskrnl base address </div><div class="ttdef"><b>Definition:</b> Private.c:57</div></div>
<div class="ttc" id="_private_8h_html_a3c82361783384ad388af4ad2f95c54e6"><div class="ttname"><a href="_private_8h.html#a3c82361783384ad388af4ad2f95c54e6">DYNAMIC_DATA</a></div><div class="ttdeci">struct _DYNAMIC_DATA DYNAMIC_DATA</div><div class="ttdoc">OS-dependent stuff </div></div>
<div class="ttc" id="struct___d_y_n_a_m_i_c___d_a_t_a_html_a98727f453ec55adc3deca10010a6219e"><div class="ttname"><a href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a98727f453ec55adc3deca10010a6219e">_DYNAMIC_DATA::ObjTable</a></div><div class="ttdeci">ULONG ObjTable</div><div class="ttdef"><b>Definition:</b> Private.h:102</div></div>
<div class="ttc" id="struct___m_m_a_d_d_r_e_s_s___n_o_d_e_html"><div class="ttname"><a href="struct___m_m_a_d_d_r_e_s_s___n_o_d_e.html">_MMADDRESS_NODE</a></div><div class="ttdef"><b>Definition:</b> NativeStructs7.h:101</div></div>
<div class="ttc" id="struct___d_y_n_a_m_i_c___d_a_t_a_html_a7c20b1b98814bcb31ff8f53bedd64f06"><div class="ttname"><a href="struct___d_y_n_a_m_i_c___d_a_t_a.html#a7c20b1b98814bcb31ff8f53bedd64f06">_DYNAMIC_DATA::ver</a></div><div class="ttdeci">WinVer ver</div><div class="ttdef"><b>Definition:</b> Private.h:98</div></div>
<div class="ttc" id="_private_8h_html_a505c81a103cfd0b7b641a73c32278667"><div class="ttname"><a href="_private_8h.html#a505c81a103cfd0b7b641a73c32278667">DesiredAccess</a></div><div class="ttdeci">IN ACCESS_MASK DesiredAccess</div><div class="ttdef"><b>Definition:</b> Private.h:115</div></div>
<div class="ttc" id="_private_8h_html_a823253fd4f06f8d17de90cd8a7e91b17"><div class="ttname"><a href="_private_8h.html#a823253fd4f06f8d17de90cd8a7e91b17">SizeOfStackCommit</a></div><div class="ttdeci">IN ACCESS_MASK IN PVOID IN HANDLE IN PVOID IN PVOID IN ULONG IN SIZE_T IN SIZE_T SizeOfStackCommit</div><div class="ttdef"><b>Definition:</b> Private.h:115</div></div>
<div class="ttc" id="_private_8h_html_ac9cfc5738ea3990637e2464b1fd7e908"><div class="ttname"><a href="_private_8h.html#ac9cfc5738ea3990637e2464b1fd7e908">WinVer</a></div><div class="ttdeci">enum _WinVer WinVer</div></div>
<div class="ttc" id="struct___d_y_n_a_m_i_c___d_a_t_a_html_ab9cc96d4ac961191e931db74b923c1c6"><div class="ttname"><a href="struct___d_y_n_a_m_i_c___d_a_t_a.html#ab9cc96d4ac961191e931db74b923c1c6">_DYNAMIC_DATA::KExecOpt</a></div><div class="ttdeci">ULONG KExecOpt</div><div class="ttdef"><b>Definition:</b> Private.h:100</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_1be4885ae0f8fc825ada64c048101ff4.html">Visual Studio 2013</a></li><li class="navelem"><a class="el" href="dir_cff6504ebdd213a64976c6fc552b82ee.html">Projects</a></li><li class="navelem"><a class="el" href="dir_b716da8d3aa0fe4ae2f6139a1f666f87.html">BlackBone</a></li><li class="navelem"><a class="el" href="dir_ad2d131fed674adc088bc470bbb2e438.html">src</a></li><li class="navelem"><a class="el" href="dir_ddc31af3ab12d58410e17a5b1105cec8.html">BlackBoneDrv</a></li><li class="navelem"><a class="el" href="_private_8h.html">Private.h</a></li>
    <li class="footer">Generated on Tue Sep 23 2014 11:50:43 for BlackBone by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
