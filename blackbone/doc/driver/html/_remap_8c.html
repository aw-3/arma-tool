<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>BlackBone: C:/Users/Ton/Documents/Visual Studio 2013/Projects/BlackBone/src/BlackBoneDrv/Remap.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BlackBone
   </div>
   <div id="projectbrief">Windows memory hacking library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_remap_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Remap.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_remap_8h_source.html">Remap.h</a>&quot;</code><br />
<code>#include &lt;Ntstrsafe.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a11b75ba73289267143bd142c8e18750e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a11b75ba73289267143bd142c8e18750e">BBBuildProcessRegionListForRange</a> (IN PLIST_ENTRY pList, IN ULONG_PTR start, IN ULONG_PTR end, IN BOOLEAN mapSections)</td></tr>
<tr class="memdesc:a11b75ba73289267143bd142c8e18750e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerate committed, accessible, non-guarded memory regions  <a href="#a11b75ba73289267143bd142c8e18750e">More...</a><br /></td></tr>
<tr class="separator:a11b75ba73289267143bd142c8e18750e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac54bb573601aebf34fa18151d0163fd2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#ac54bb573601aebf34fa18151d0163fd2">BBPrepareMDLList</a> (IN PLIST_ENTRY pList)</td></tr>
<tr class="memdesc:ac54bb573601aebf34fa18151d0163fd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Walk region list and create MDL for each region  <a href="#ac54bb573601aebf34fa18151d0163fd2">More...</a><br /></td></tr>
<tr class="separator:ac54bb573601aebf34fa18151d0163fd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09fbafd63633eff0b0c23ee2ca803255"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a09fbafd63633eff0b0c23ee2ca803255">BBPrepareMDLListEntry</a> (IN <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a> pEntry)</td></tr>
<tr class="memdesc:a09fbafd63633eff0b0c23ee2ca803255"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build MDL for memory region  <a href="#a09fbafd63633eff0b0c23ee2ca803255">More...</a><br /></td></tr>
<tr class="separator:a09fbafd63633eff0b0c23ee2ca803255"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58da9a40f5285a92264e5f6960ecc38a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a58da9a40f5285a92264e5f6960ecc38a">BBMapRegionListIntoCurrentProcess</a> (IN PLIST_ENTRY pList, IN BOOLEAN noWarning)</td></tr>
<tr class="memdesc:a58da9a40f5285a92264e5f6960ecc38a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map locked physical pages into caller process  <a href="#a58da9a40f5285a92264e5f6960ecc38a">More...</a><br /></td></tr>
<tr class="separator:a58da9a40f5285a92264e5f6960ecc38a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae74fd0959ad7136063b9ed02ee50740f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#ae74fd0959ad7136063b9ed02ee50740f">BBMapRegionIntoCurrentProcess</a> (IN <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a> pEntry, IN <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a> pPrevEntry)</td></tr>
<tr class="memdesc:ae74fd0959ad7136063b9ed02ee50740f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map locked physical pages into caller process  <a href="#ae74fd0959ad7136063b9ed02ee50740f">More...</a><br /></td></tr>
<tr class="separator:ae74fd0959ad7136063b9ed02ee50740f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0835e6ed7b558cc2bbf101b4ebae9c05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a0835e6ed7b558cc2bbf101b4ebae9c05">BBAllocateSharedPage</a> (OUT PVOID *pPage, OUT PMDL *pResultMDL)</td></tr>
<tr class="memdesc:a0835e6ed7b558cc2bbf101b4ebae9c05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate kernel page from NonPaged pool and build MDL for it  <a href="#a0835e6ed7b558cc2bbf101b4ebae9c05">More...</a><br /></td></tr>
<tr class="separator:a0835e6ed7b558cc2bbf101b4ebae9c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92d04abe3edc00718bd7758d73518f9f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a92d04abe3edc00718bd7758d73518f9f">BBMapSharedPage</a> (IN PMDL pMDL, OUT PVOID *pResult)</td></tr>
<tr class="memdesc:a92d04abe3edc00718bd7758d73518f9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map kernel page into current process address space  <a href="#a92d04abe3edc00718bd7758d73518f9f">More...</a><br /></td></tr>
<tr class="separator:a92d04abe3edc00718bd7758d73518f9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98e0da85e5255e13acb7b79f28a110e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a98e0da85e5255e13acb7b79f28a110e2">BBConsolidateRegionList</a> (IN PLIST_ENTRY pList)</td></tr>
<tr class="memdesc:a98e0da85e5255e13acb7b79f28a110e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Consolidate adjacent memory regions  <a href="#a98e0da85e5255e13acb7b79f28a110e2">More...</a><br /></td></tr>
<tr class="separator:a98e0da85e5255e13acb7b79f28a110e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6244c80d71f22b3c7aad4582842d86a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a6244c80d71f22b3c7aad4582842d86a6">BBHandleSharedRegion</a> (IN <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a> pEntry)</td></tr>
<tr class="memdesc:a6244c80d71f22b3c7aad4582842d86a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process section object pages Function will attempt to trigger copy-on-write for underlying pages to convert them into private If copy-on-write fails, region will be then mapped as read-only  <a href="#a6244c80d71f22b3c7aad4582842d86a6">More...</a><br /></td></tr>
<tr class="separator:a6244c80d71f22b3c7aad4582842d86a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca917f20fffef1a06b64d9f8747d5a21"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#aca917f20fffef1a06b64d9f8747d5a21">BBUnmapRegionEntry</a> (IN <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a> pPageEntry, IN <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a> pFoundEntry)</td></tr>
<tr class="memdesc:aca917f20fffef1a06b64d9f8747d5a21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmap memory region, release corresponding MDL, and remove region form list  <a href="#aca917f20fffef1a06b64d9f8747d5a21">More...</a><br /></td></tr>
<tr class="separator:aca917f20fffef1a06b64d9f8747d5a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66813163ee3a67afd8f20015d11aa3c9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a66813163ee3a67afd8f20015d11aa3c9">BBFindPageEntry</a> (IN PLIST_ENTRY pList, IN ULONG_PTR baseAddress, IN ULONG_PTR size)</td></tr>
<tr class="memdesc:a66813163ee3a67afd8f20015d11aa3c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find memory region containing at least one byte from specific region  <a href="#a66813163ee3a67afd8f20015d11aa3c9">More...</a><br /></td></tr>
<tr class="separator:a66813163ee3a67afd8f20015d11aa3c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50ca5d0ccc42e4adb2dcfd43c38f8f3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a50ca5d0ccc42e4adb2dcfd43c38f8f3b">BBCleanupPageList</a> (IN BOOLEAN attached, IN PLIST_ENTRY pList)</td></tr>
<tr class="memdesc:a50ca5d0ccc42e4adb2dcfd43c38f8f3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmap pages, destroy MDLs, remove entry from list  <a href="#a50ca5d0ccc42e4adb2dcfd43c38f8f3b">More...</a><br /></td></tr>
<tr class="separator:a50ca5d0ccc42e4adb2dcfd43c38f8f3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bc394ae8ea397352b69aea5b8f824ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a7bc394ae8ea397352b69aea5b8f824ba">BBSafeHandleClose</a> (IN PEPROCESS pProcess, IN HANDLE handle, IN KPROCESSOR_MODE mode)</td></tr>
<tr class="memdesc:a7bc394ae8ea397352b69aea5b8f824ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close handle if process isn't in signaled state  <a href="#a7bc394ae8ea397352b69aea5b8f824ba">More...</a><br /></td></tr>
<tr class="separator:a7bc394ae8ea397352b69aea5b8f824ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a437717f5fe0068e8f8f6275e8c461f4b"><td class="memItemLeft" align="right" valign="top">RTL_GENERIC_COMPARE_RESULTS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a437717f5fe0068e8f8f6275e8c461f4b">AvlCompare</a> (IN RTL_AVL_TABLE *Table, IN PVOID FirstStruct, IN PVOID SecondStruct)</td></tr>
<tr class="separator:a437717f5fe0068e8f8f6275e8c461f4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88fc15832706f815eae8775b4331ac1b"><td class="memItemLeft" align="right" valign="top">PVOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a88fc15832706f815eae8775b4331ac1b">AvlAllocate</a> (IN RTL_AVL_TABLE *Table, IN CLONG ByteSize)</td></tr>
<tr class="separator:a88fc15832706f815eae8775b4331ac1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2922b8d15af96c5c1679492bf15e776"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#ae2922b8d15af96c5c1679492bf15e776">AvlFree</a> (IN RTL_AVL_TABLE *Table, IN PVOID Buffer)</td></tr>
<tr class="separator:ae2922b8d15af96c5c1679492bf15e776"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa34fd8c82f1edae8f913704d00399c53"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#aa34fd8c82f1edae8f913704d00399c53">BBPrepareMDLListEntry</a> (IN OUT <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a> pEntry)</td></tr>
<tr class="memdesc:aa34fd8c82f1edae8f913704d00399c53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build MDL for memory region  <a href="#aa34fd8c82f1edae8f913704d00399c53">More...</a><br /></td></tr>
<tr class="separator:aa34fd8c82f1edae8f913704d00399c53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477ab35d84eaab6198cd8c2b36966df5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a477ab35d84eaab6198cd8c2b36966df5">BBMapMemory</a> (IN <a class="el" href="_black_bone_def_8h.html#a756d94b3d8b59bf911ebef69c31224e3">PMAP_MEMORY</a> pRemap, OUT <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a> *ppEntry)</td></tr>
<tr class="memdesc:a477ab35d84eaab6198cd8c2b36966df5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map entire address space of target process into current Subsequent calls won't map any additional regions, only return info about existing mapping  <a href="#a477ab35d84eaab6198cd8c2b36966df5">More...</a><br /></td></tr>
<tr class="separator:a477ab35d84eaab6198cd8c2b36966df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add6826b20572e5728507d4c040351cfd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#add6826b20572e5728507d4c040351cfd">BBMapMemoryRegion</a> (IN <a class="el" href="_black_bone_def_8h.html#a1973bf123a2adca43b1411769fb6153f">PMAP_MEMORY_REGION</a> pRegion, OUT <a class="el" href="_black_bone_def_8h.html#a7d8cb706531527e27eccba284162b7f4">PMAP_MEMORY_REGION_RESULT</a> pResult)</td></tr>
<tr class="memdesc:add6826b20572e5728507d4c040351cfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map specific memory region  <a href="#add6826b20572e5728507d4c040351cfd">More...</a><br /></td></tr>
<tr class="separator:add6826b20572e5728507d4c040351cfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cb21cac2fa196ad5abff8a9e90baee7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a1cb21cac2fa196ad5abff8a9e90baee7">BBUnmapMemory</a> (IN <a class="el" href="_black_bone_def_8h.html#aee5703b358f0279a38c1469f5126af8d">PUNMAP_MEMORY</a> pUnmap)</td></tr>
<tr class="memdesc:a1cb21cac2fa196ad5abff8a9e90baee7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmap any mapped memory from host and target processes  <a href="#a1cb21cac2fa196ad5abff8a9e90baee7">More...</a><br /></td></tr>
<tr class="separator:a1cb21cac2fa196ad5abff8a9e90baee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ed588f0df58d216e8593eb5e4a686f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a10ed588f0df58d216e8593eb5e4a686f">BBUnmapMemoryRegion</a> (IN <a class="el" href="_black_bone_def_8h.html#abe98aab52e6513851c7238d73233ba5e">PUNMAP_MEMORY_REGION</a> pRegion)</td></tr>
<tr class="memdesc:a10ed588f0df58d216e8593eb5e4a686f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmap specific memory region  <a href="#a10ed588f0df58d216e8593eb5e4a686f">More...</a><br /></td></tr>
<tr class="separator:a10ed588f0df58d216e8593eb5e4a686f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7c25319f3aeb357cc37a64f3cb13b53"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#ac7c25319f3aeb357cc37a64f3cb13b53">BBCleanupProcessEntry</a> (IN <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a> pProcessEntry)</td></tr>
<tr class="memdesc:ac7c25319f3aeb357cc37a64f3cb13b53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmap all regions, delete MDLs, close handles, remove entry from table  <a href="#ac7c25319f3aeb357cc37a64f3cb13b53">More...</a><br /></td></tr>
<tr class="separator:ac7c25319f3aeb357cc37a64f3cb13b53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6678da5eb92b81e33d87f7490951007"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#ad6678da5eb92b81e33d87f7490951007">BBCleanupHostProcess</a> (IN <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a> pProcessEntry)</td></tr>
<tr class="memdesc:ad6678da5eb92b81e33d87f7490951007"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmap any mapped pages from host process  <a href="#ad6678da5eb92b81e33d87f7490951007">More...</a><br /></td></tr>
<tr class="separator:ad6678da5eb92b81e33d87f7490951007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45970f9f711d6e19c5ee03242eee5261"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a45970f9f711d6e19c5ee03242eee5261">BBCleanupProcessTable</a> ()</td></tr>
<tr class="memdesc:a45970f9f711d6e19c5ee03242eee5261"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear global process map table  <a href="#a45970f9f711d6e19c5ee03242eee5261">More...</a><br /></td></tr>
<tr class="separator:a45970f9f711d6e19c5ee03242eee5261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9160b10f2c993aa5b93d95b83004a46"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#ab9160b10f2c993aa5b93d95b83004a46">BBLookupProcessEntry</a> (IN HANDLE pid, IN BOOLEAN asHost)</td></tr>
<tr class="memdesc:ab9160b10f2c993aa5b93d95b83004a46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search process entry in list by PID  <a href="#ab9160b10f2c993aa5b93d95b83004a46">More...</a><br /></td></tr>
<tr class="separator:ab9160b10f2c993aa5b93d95b83004a46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e26085ed53a0a82250d5f519fa91e57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a3e26085ed53a0a82250d5f519fa91e57">BBGetRequiredRemapOutputSize</a> (IN PLIST_ENTRY pList, OUT PULONG_PTR pSize)</td></tr>
<tr class="memdesc:a3e26085ed53a0a82250d5f519fa91e57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate size required to store mapping info  <a href="#a3e26085ed53a0a82250d5f519fa91e57">More...</a><br /></td></tr>
<tr class="separator:a3e26085ed53a0a82250d5f519fa91e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab73cc47e1b1ffbd3b4935a2eb26cf4a9"><td class="memItemLeft" align="right" valign="top">RTL_AVL_TABLE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#ab73cc47e1b1ffbd3b4935a2eb26cf4a9">g_ProcessPageTables</a></td></tr>
<tr class="separator:ab73cc47e1b1ffbd3b4935a2eb26cf4a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16b32ee30960d149d4d4b6eec91f45fa"><td class="memItemLeft" align="right" valign="top">KGUARDED_MUTEX&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_remap_8c.html#a16b32ee30960d149d4d4b6eec91f45fa">g_globalLock</a></td></tr>
<tr class="separator:a16b32ee30960d149d4d4b6eec91f45fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a88fc15832706f815eae8775b4331ac1b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PVOID AvlAllocate </td>
          <td>(</td>
          <td class="paramtype">IN RTL_AVL_TABLE *&#160;</td>
          <td class="paramname"><em>Table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CLONG&#160;</td>
          <td class="paramname"><em>ByteSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a437717f5fe0068e8f8f6275e8c461f4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RTL_GENERIC_COMPARE_RESULTS AvlCompare </td>
          <td>(</td>
          <td class="paramtype">IN RTL_AVL_TABLE *&#160;</td>
          <td class="paramname"><em>Table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN PVOID&#160;</td>
          <td class="paramname"><em>FirstStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN PVOID&#160;</td>
          <td class="paramname"><em>SecondStruct</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae2922b8d15af96c5c1679492bf15e776"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a> AvlFree </td>
          <td>(</td>
          <td class="paramtype">IN RTL_AVL_TABLE *&#160;</td>
          <td class="paramname"><em>Table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN PVOID&#160;</td>
          <td class="paramname"><em>Buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0835e6ed7b558cc2bbf101b4ebae9c05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBAllocateSharedPage </td>
          <td>(</td>
          <td class="paramtype">OUT PVOID *&#160;</td>
          <td class="paramname"><em>pPage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT PMDL *&#160;</td>
          <td class="paramname"><em>pResultMDL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate kernel page from NonPaged pool and build MDL for it </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pPage</td><td>Resulting address</td></tr>
    <tr><td class="paramname">pResultMDL</td><td>Resulting MDL</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a11b75ba73289267143bd142c8e18750e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBBuildProcessRegionListForRange </td>
          <td>(</td>
          <td class="paramtype">IN PLIST_ENTRY&#160;</td>
          <td class="paramname"><em>pList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN ULONG_PTR&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN ULONG_PTR&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN&#160;</td>
          <td class="paramname"><em>mapSections</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumerate committed, accessible, non-guarded memory regions </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pList</td><td>Region list</td></tr>
    <tr><td class="paramname">start</td><td>Region start</td></tr>
    <tr><td class="paramname">end</td><td>Region end</td></tr>
    <tr><td class="paramname">mapSections</td><td>If set to FALSE, section objects will be excluded from list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="ad6678da5eb92b81e33d87f7490951007"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a> BBCleanupHostProcess </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a>&#160;</td>
          <td class="paramname"><em>pProcessEntry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unmap any mapped pages from host process </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pProcessEntry</td><td>Process entry</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a50ca5d0ccc42e4adb2dcfd43c38f8f3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a> BBCleanupPageList </td>
          <td>(</td>
          <td class="paramtype">IN BOOLEAN&#160;</td>
          <td class="paramname"><em>attached</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN PLIST_ENTRY&#160;</td>
          <td class="paramname"><em>pList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unmap pages, destroy MDLs, remove entry from list </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attached</td><td>TRUE indicates that function is executed in the context of host process and pages can be safely unmapped</td></tr>
    <tr><td class="paramname">pList</td><td>Region list</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac7c25319f3aeb357cc37a64f3cb13b53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a> BBCleanupProcessEntry </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a>&#160;</td>
          <td class="paramname"><em>pProcessEntry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unmap all regions, delete MDLs, close handles, remove entry from table </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pProcessEntry</td><td>Process entry</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a45970f9f711d6e19c5ee03242eee5261"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_imports_8h.html#ae806732a128a903844d92e71141fb7cd">VOID</a> BBCleanupProcessTable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear global process map table </p>

</div>
</div>
<a class="anchor" id="a98e0da85e5255e13acb7b79f28a110e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBConsolidateRegionList </td>
          <td>(</td>
          <td class="paramtype">IN PLIST_ENTRY&#160;</td>
          <td class="paramname"><em>pList</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Consolidate adjacent memory regions </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pList</td><td>Region list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a66813163ee3a67afd8f20015d11aa3c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a> BBFindPageEntry </td>
          <td>(</td>
          <td class="paramtype">IN PLIST_ENTRY&#160;</td>
          <td class="paramname"><em>pList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN ULONG_PTR&#160;</td>
          <td class="paramname"><em>baseAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN ULONG_PTR&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find memory region containing at least one byte from specific region </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pList</td><td>Region list to search in</td></tr>
    <tr><td class="paramname">baseAddress</td><td>Base of region to find</td></tr>
    <tr><td class="paramname">size</td><td>Size of the region to find</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a3e26085ed53a0a82250d5f519fa91e57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBGetRequiredRemapOutputSize </td>
          <td>(</td>
          <td class="paramtype">IN PLIST_ENTRY&#160;</td>
          <td class="paramname"><em>pList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT PULONG_PTR&#160;</td>
          <td class="paramname"><em>pSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate size required to store mapping info </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pList</td><td>Mapped regions list</td></tr>
    <tr><td class="paramname">pSize</td><td>Resulting size</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a6244c80d71f22b3c7aad4582842d86a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBHandleSharedRegion </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a>&#160;</td>
          <td class="paramname"><em>pEntry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process section object pages Function will attempt to trigger copy-on-write for underlying pages to convert them into private If copy-on-write fails, region will be then mapped as read-only </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pEntry</td><td>Region data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="ab9160b10f2c993aa5b93d95b83004a46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a> BBLookupProcessEntry </td>
          <td>(</td>
          <td class="paramtype">IN HANDLE&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN&#160;</td>
          <td class="paramname"><em>asHost</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search process entry in list by PID </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pid</td><td>PID.</td></tr>
    <tr><td class="paramname">asHost</td><td>If set to TRUE, pid is treated as host PID</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Found entry, NULL in not found</dd></dl>

</div>
</div>
<a class="anchor" id="a477ab35d84eaab6198cd8c2b36966df5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBMapMemory </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_black_bone_def_8h.html#a756d94b3d8b59bf911ebef69c31224e3">PMAP_MEMORY</a>&#160;</td>
          <td class="paramname"><em>pRemap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a> *&#160;</td>
          <td class="paramname"><em>ppEntry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map entire address space of target process into current Subsequent calls won't map any additional regions, only return info about existing mapping </p>
<p>Map entire address space of target process into current </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pRemap</td><td>Mapping params</td></tr>
    <tr><td class="paramname">ppEntry</td><td>Mapped context</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="add6826b20572e5728507d4c040351cfd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBMapMemoryRegion </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_black_bone_def_8h.html#a1973bf123a2adca43b1411769fb6153f">PMAP_MEMORY_REGION</a>&#160;</td>
          <td class="paramname"><em>pRegion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT <a class="el" href="_black_bone_def_8h.html#a7d8cb706531527e27eccba284162b7f4">PMAP_MEMORY_REGION_RESULT</a>&#160;</td>
          <td class="paramname"><em>pResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map specific memory region </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pRegion</td><td>Region data</td></tr>
    <tr><td class="paramname">pResult</td><td>Mapping results</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="ae74fd0959ad7136063b9ed02ee50740f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBMapRegionIntoCurrentProcess </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a>&#160;</td>
          <td class="paramname"><em>pEntry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a>&#160;</td>
          <td class="paramname"><em>pPrevEntry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map locked physical pages into caller process </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pEntry</td><td>Memory region</td></tr>
    <tr><td class="paramname">pPrevEntry</td><td>Last mapped region</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a58da9a40f5285a92264e5f6960ecc38a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBMapRegionListIntoCurrentProcess </td>
          <td>(</td>
          <td class="paramtype">IN PLIST_ENTRY&#160;</td>
          <td class="paramname"><em>pList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN&#160;</td>
          <td class="paramname"><em>noWarning</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map locked physical pages into caller process </p>
<p>Map memory regions into caller process </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pList</td><td>Region list</td></tr>
    <tr><td class="paramname">noWarning</td><td>If set to FALSE, warning will be printed if region is already mapped</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a92d04abe3edc00718bd7758d73518f9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBMapSharedPage </td>
          <td>(</td>
          <td class="paramtype">IN PMDL&#160;</td>
          <td class="paramname"><em>pMDL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT PVOID *&#160;</td>
          <td class="paramname"><em>pResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map kernel page into current process address space </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pMDL</td><td>Page MDL</td></tr>
    <tr><td class="paramname">pResult</td><td>Mapped address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="ac54bb573601aebf34fa18151d0163fd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBPrepareMDLList </td>
          <td>(</td>
          <td class="paramtype">IN PLIST_ENTRY&#160;</td>
          <td class="paramname"><em>pList</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Walk region list and create MDL for each region </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pList</td><td>Region list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a09fbafd63633eff0b0c23ee2ca803255"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBPrepareMDLListEntry </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a>&#160;</td>
          <td class="paramname"><em>pEntry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build MDL for memory region </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pEntry</td><td>Region data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="aa34fd8c82f1edae8f913704d00399c53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBPrepareMDLListEntry </td>
          <td>(</td>
          <td class="paramtype">IN OUT <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a>&#160;</td>
          <td class="paramname"><em>pEntry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build MDL for memory region </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pEntry</td><td>Region data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a7bc394ae8ea397352b69aea5b8f824ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBSafeHandleClose </td>
          <td>(</td>
          <td class="paramtype">IN PEPROCESS&#160;</td>
          <td class="paramname"><em>pProcess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN HANDLE&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN KPROCESSOR_MODE&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close handle if process isn't in signaled state </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pProcess</td><td>Process object</td></tr>
    <tr><td class="paramname">handle</td><td>Handle</td></tr>
    <tr><td class="paramname">mode</td><td>KernelMode or UserMode handle</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a1cb21cac2fa196ad5abff8a9e90baee7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBUnmapMemory </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_black_bone_def_8h.html#aee5703b358f0279a38c1469f5126af8d">PUNMAP_MEMORY</a>&#160;</td>
          <td class="paramname"><em>pUnmap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unmap any mapped memory from host and target processes </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pUnmap</td><td>Request params</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<a class="anchor" id="a10ed588f0df58d216e8593eb5e4a686f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBUnmapMemoryRegion </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_black_bone_def_8h.html#abe98aab52e6513851c7238d73233ba5e">PUNMAP_MEMORY_REGION</a>&#160;</td>
          <td class="paramname"><em>pRegion</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unmap specific memory region </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pRegion</td><td>Region info</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status ode</dd></dl>

</div>
</div>
<a class="anchor" id="aca917f20fffef1a06b64d9f8747d5a21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_private_8h.html#afa7140c76ae020a5271b3181ccb8b512">NTSTATUS</a> BBUnmapRegionEntry </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_remap_8h.html#aa273bd9c4061c76fe1e2b5d0c59f85dc">PMAP_ENTRY</a>&#160;</td>
          <td class="paramname"><em>pPageEntry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_remap_8h.html#afeeaf100ad47c01b3a067e5c9cb218d2">PPROCESS_MAP_ENTRY</a>&#160;</td>
          <td class="paramname"><em>pFoundEntry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unmap memory region, release corresponding MDL, and remove region form list </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pPageEntry</td><td>Region data</td></tr>
    <tr><td class="paramname">pFoundEntry</td><td>Process data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code</dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a16b32ee30960d149d4d4b6eec91f45fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KGUARDED_MUTEX g_globalLock</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab73cc47e1b1ffbd3b4935a2eb26cf4a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RTL_AVL_TABLE g_ProcessPageTables</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_1be4885ae0f8fc825ada64c048101ff4.html">Visual Studio 2013</a></li><li class="navelem"><a class="el" href="dir_cff6504ebdd213a64976c6fc552b82ee.html">Projects</a></li><li class="navelem"><a class="el" href="dir_b716da8d3aa0fe4ae2f6139a1f666f87.html">BlackBone</a></li><li class="navelem"><a class="el" href="dir_ad2d131fed674adc088bc470bbb2e438.html">src</a></li><li class="navelem"><a class="el" href="dir_ddc31af3ab12d58410e17a5b1105cec8.html">BlackBoneDrv</a></li><li class="navelem"><a class="el" href="_remap_8c.html">Remap.c</a></li>
    <li class="footer">Generated on Tue Sep 23 2014 11:50:44 for BlackBone by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
